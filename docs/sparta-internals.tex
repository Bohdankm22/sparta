\htmlhr
\chapter{SPARTA internals\label{sparta-internals}}

This document contains details that are only relevant for
people inside the SPARTA team at UW.

The SPARTA team uses four Mercurial repositories:
\<sparta-code> for the source code of the SPARTA toolset,
\<sparta-subjects> for test applications (case studies),
\<sparta-meetings> for notes about UW team meetings, and
\<apac-meetings> for notes about DARPA meetings.

To get a copy do:

\begin{alltt}
hg clone https://dada.cs.washington.edu/hgweb/sparta-code
\end{alltt}

\noindent
and similarly for the other three repositories.

To push your changes to the repository you need to be in the \<sparta> Unix
group. Contact Werner or Mike to get the permission.  Also, if you are
going to push changes, please add a \<.hgrc> file to your home directory on
the server.  The \<.hgrc> file should contain:

\begin{verbatim} 
[trusted]
users = wmdietl
groups = sparta
\end{verbatim}

This allows emails to be sent when you push changes. 

Note that SPARTA as well as the Checker Framework are evolving
rapidly.
Thus you should periodically get the latest version of the source code (by
running \<hg fetch>) and
rebuild the projects.


After installing your copy, try to run \<ant> in \<sparta-subjects/Sky>:

\begin{Verbatim}
$ ant flowtest
\end{Verbatim}

If it gives results like this, you're ready to work on annotating!

\begin{smaller}
\begin{alltt}
[jsr308.javac] .../sparta-subjects/Sky/src/org/jsharkey/sky/WebserviceHelper.java:308: error: incompatible types.
[jsr308.javac]             HttpGet request = new HttpGet(String.format(WEBSERVICE_URL, lat, lon, days));
[jsr308.javac]                                                        ^
[jsr308.javac]   found   : @Sinks @Sources String
[jsr308.javac]   required: @sparta.checkers.quals.Sinks({sparta.checkers.quals.SPARTA\_Permission.NETWORK}) @Sources String
\end{alltt}
\end{smaller}

If you want to add a new application, put it under the
\<sparta-subjects> directory.

You may need to get Android source code to get sense of what API returns (or
gets) what type of data. See \url{http://source.android.com/source/index.html}
You can find the list of all APIs from the Android source code in 
\<frameworks/base/api/15.txt> - api list for api version 15 (Android 4.0.3)
Accessing resource is closely related to Android permissions (some of the
resources are not protected with permissions though).
The Android permission list is at:
\url{http://developer.android.com/reference/android/Manifest.permission.html}.
Hints to add annotations could be permissionmap (which permission is required
to call which functions):
\url{http://www.android-permissions.org/permissionmap.html}.



%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "manual"
%%% TeX-command-default: "PDF"
%%% End: 

%  LocalWords:  sparta apac hg jsr308 HttpGet WEBSERVICE lon Sinks
%  LocalWords:  Sources hgrc
